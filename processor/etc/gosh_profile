# add methods on BundleContext object as commands
addcommand context ${.context}

# add methods on System object as commands
addcommand system (((${.context} getClass) getClassLoader) loadClass java.lang.System)


# Load base profile
tura_home = system:getproperty TURA_HOME
repo_home = $tura_home/processor/etc
user_home = system:getproperty user.home


source $repo_home/go.ext


try {

setproperty chromedriverversion '2.40'
setproperty mavenurl 'https://archive.apache.org/dist/maven/maven-3/3.5.2/binaries/apache-maven-3.5.2-bin.zip' 
tura_home = system:getproperty TURA_HOME

complete -c tura:install -e
complete -c tura:install -d "Tura install" 
complete -c tura:install -a '__install_picocliCompleter'

complete -c tura:generate -e
complete -c tura:generate -d "Generate recipe" 
complete -c tura:generate -a '__generate_picocliCompleter'

complete -c tura:build -e
complete -c tura:build -d "Build recipe" 
complete -c tura:build -a '__build_picocliCompleter'

complete -c tura:mvn -e
complete -c tura:mvn -d "Build maven project" 
complete -c tura:mvn -a '__mvn_picocliCompleter'


complete -c tura:docker -e
complete -c tura:docker -d "Run docker" 
complete -c tura:docker -a '__docker_picocliCompleter'


complete -c tura:dsl -e
complete -c tura:dsl -d "Dsl for configuration" 
complete -c tura:dsl -a '__dsl_picocliCompleter'


complete -c tura:closure -e
complete -c tura:closure -d "Closure for configuration" 
complete -c tura:closure -a '__closure_Completer'




buildPluginAndProcessor = {
     source $tura_home/processor/etc/buildPluginAndProcessor;    
}
addClosure "buildPluginAndProcessor";


buildPlatform = {
     source $tura_home/processor/etc/buildPlatform;    
}
addClosure "buildPlatform";


startHRApplication = {
     stopSAApplication;
     source $tura_home/processor/etc/hr-manager-deployment.recipe;    
}
addClosure "startHRApplication";


stopHRApplication = {
     source $tura_home/processor/etc/hr-manager-stop-all.recipe;    
}
addClosure "stopHRApplication";



startHRIntegrationTest = {
     tura:mvn build --pom.xml $tura_home/examples/hr-manager/integration-testing/pom.xml;    
}
addClosure "startHRIntegrationTest";



generateHRApplication = {
      tura:generate --build --recipeId 4b203e22-0ea6-4cf8-9c3e-8c1040e73dc5 --infraId 25ebeb54-7003-4e72-bacc-3d8de138ac52 --modelFile $tura_home/examples/hr-manager/org.tura.metamodel.example.sirius.hr/model/hr.domain

}
addClosure "generateHRApplication";


buildHRApplication = {
      tura:build --recipeId 4b203e22-0ea6-4cf8-9c3e-8c1040e73dc5 --infraId 25ebeb54-7003-4e72-bacc-3d8de138ac52 --modelFile $tura_home/examples/hr-manager/org.tura.metamodel.example.sirius.hr/model/hr.domain
}
addClosure "buildHRApplication";


hrUrlList = {
    echo 'https://localhost:8443/hrform/hrmanager/hrcontroller/HRController.xhtml?param1=qwerty2           qwerty/qwerty'
    echo 'http://localhost:8080/hrform/hrmanager/miscelements/MiscElementsWindow.xhtml'
    echo 'http://localhost:8080/hrform/hrmanager/tree2tree/Tree2TreeRelations.xhtml'

}
addClosure "hrUrlList";


hrLogWatch = {
   tura:docker logWatcher --name hr-wf --name hr-pg 

}
addClosure "hrLogWatch";



startSAApplication = {
     stopHRApplication;
     dump_file = $repo_home/sales-analyzer/assets/SalesAnalyzerDB.dump
     source $tura_home/processor/etc/sales-analyzer-start-server.recipe;    
}
addClosure "startSAApplication";


startSAApplicationWithData = {
     stopHRApplication;
     dump_file = $repo_home/sales-analyzer/assets/SalesAnalyzerWithCasesDB.dump
     source $tura_home/processor/etc/sales-analyzer-start-server.recipe;    
}
addClosure "startSAApplicationWithData";



stopSAApplication = {
     source $tura_home/processor/etc/sales-analyzer-stop-server.recipe;    
}
addClosure "stopSAApplication";


startSAIntegrationTest = {
     tura:mvn build --pom.xml $tura_home/examples/sales-analyzer/sales-analyzer/integration-testing/pom.xml;    
}
addClosure "startSAIntegrationTest";


generateSAApplication = {
     tura:generate --build --recipeId be05f6ff-7dc2-4ff5-bea1-dba53a6e76c3 --infraId 92f00187-c3de-4091-8eca-850df9713ef5 --modelFile $tura_home/examples/hr-manager/org.tura.metamodel.example.sirius.hr/model/hr.domain

}
addClosure "generateSAApplication";


buildSAApplication = {
     tura:build --recipeId be05f6ff-7dc2-4ff5-bea1-dba53a6e76c3 --infraId 92f00187-c3de-4091-8eca-850df9713ef5 --modelFile $tura_home/examples/hr-manager/org.tura.metamodel.example.sirius.hr/model/hr.domain

}
addClosure "buildSAApplication";


saUrlList = {
    echo 'service:jmx:remote+http://wf:9991                                                    admin/qwerty'
    echo 'http://kc:8080/auth/admin/master/console/                                            admin/qwerty'
    echo 'http://wf:8081/sa-admin/admin/administration/AdminWindow.xhtml                       sales-manager/sales01'
    echo 'http://wf:8081/sa-case-manager/analysis/casemanager/WorkItemWindow.xhtml             sales-manager/sales01'
    echo 'http://wf:8081/sa-etl-controller/dataloader/etlcontroller/ETLControlWindow.xhtml     sales-manager/sales01' 
}
addClosure "saUrlList";


saLogWatch = {
   tura:docker logWatcher --name sa-wf --name sa-kc --name sa-pg 
}
addClosure "saLogWatch";


removeAll = {
     source $tura_home/processor/etc/remove-all.recipe;    
}
addClosure "removeAll";

postInit;

} catch {
    $exception printStackTrace
    e
}

