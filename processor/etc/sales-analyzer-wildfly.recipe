tura_home = system:getproperty TURA_HOME
repo_home = $tura_home/processor/etc
user_home = system:getproperty user.home

try {
tura:docker stopContainer --name sa-wf

tura:docker removeContainer --name sa-wf

tura:docker removeImage --registry tura/sa/wildfly --tag 1.0

tura:docker pullImage --registry jboss/wildfly --tag 10.1.0.Final

tura:docker createNetwork --network sa-net

c = tura:docker config --user 0

v = tura:docker createContainer --registry jboss/wildfly --tag 10.1.0.Final --var c

tura:dsl jbossStandaloneFullXml                                \
                     --container $v                            \
                     --jboss_home /opt/jboss/wildfly           \
                     --application sales-analyzer              \
                     --serverType wildfly-10.1.0.Final         \
                     --configPath postgres/docker              \
                     --configPath kie-server                   \
                     --configPath ui-app                       \
                     --property TALEND_JOB_ROOT:$tura_home/examples/sales-analyzer/talend-jobs
 
tura:dsl jbossModule --container $v                            \
                     --jboss_home /opt/jboss/wildfly           \
                     --application sales-analyzer              \
                     --serverType wildfly-10.1.0.Final         \
                     --relativeLocation config/main            \
                     --configPath talend-job-configuration     \
                     --property TURA_SOURCE_LOCATION:$tura_home

tura:dsl jbossModule  --container $v                           \
                      --jboss_home /opt/jboss/wildfly          \
                      --application sales-analyzer             \
                      --serverType wildfly-10.1.0.Final        \
                      --relativeLocation org/postgresql/main   \
                      --configPath postgres/docker 

tura:dsl copyFile     --container $v                           \
                      --targetLocation /opt/jboss/wildfly/modules/org/postgresql/main   \
                      --sourceResource $user_home/.m2/repository/org/postgresql/postgresql/42.1.1/postgresql-42.1.1.jar 


tura:dsl copyRoles    --container $v                           \
                      --jboss_home /opt/jboss/wildfly          \
                      --application sales-analyzer             \
                      --serverType wildfly-10.1.0.Final

tura:dsl copyUsers    --container $v                           \
                      --jboss_home /opt/jboss/wildfly          \
                      --application sales-analyzer             \
                      --serverType wildfly-10.1.0.Final




} catch {
  e
}

