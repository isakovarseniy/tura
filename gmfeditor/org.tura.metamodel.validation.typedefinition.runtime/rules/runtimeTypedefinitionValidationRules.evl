 context TypePointer {

  constraint PackageRef {

      guard : (new Native('org.tura.metamodel.wizard.infrastructure.Indicator')).runTime <> 0
      check :  self.packageRef.isDefined()
      message : 'Undefined  package name ' + self.eClass().name + ' not allowed'

  }
  
  constraint TypeRef {

      guard : (new Native('org.tura.metamodel.wizard.infrastructure.Indicator')).runTime <> 0
      check :  self.typeRef.isDefined()
      message : 'Undefined  type name ' + self.eClass().name + ' not allowed'

  }
  
   constraint qqqqqq{
      guard : (new Native('org.tura.metamodel.wizard.infrastructure.Indicator')).runTime <> 0
      check : self.getAllRecipeMappers()
      message : 'Runtime constraint ' + self.typeRef.name+" -->"
  } 

}

operation TypePointer getAllRecipeMappers() : Boolean { 

    var indicator = new Native('org.tura.metamodel.wizard.infrastructure.Indicator');
    var mappers =   new Native('java.util.ArrayList');  
    
    mappers.addAll(indicator.currentRecipe.mappers);
    mappers.addAll(indicator.currentIngredient.mappers);
    
    for( mapper in mappers ){
          if (  mapper.mapper.mappers.select(r|r.typeRef.uid=self.typeRef.uid).size() > 0 ){
              return true;
          }    
       }
    
   return false;
}